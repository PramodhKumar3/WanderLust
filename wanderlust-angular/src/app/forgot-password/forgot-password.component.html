<p-dialog header="Reset Password" [(visible)]="display" [modal]="true" [responsive]="true"
    [maximizable]="true" [baseZIndex]="10000" width="500" styleClass="forgot-dialog">
    <div class="step-slider-container mb-4">
        <div class="slider-labels">
            <span [ngClass]="{'active-step': !isNumberValidated}">Validate Contact</span>
            <span [ngClass]="{'active-step': isNumberValidated}">Reset Password</span>
        </div>
        <input type="range" min="1" max="2" [value]="isNumberValidated ? 2 : 1" class="slider" disabled>
    </div>

    <form class="form" [formGroup]="resetPasswordForm">
        <div *ngIf="!isNumberValidated">
            <div class="form-group">
                <label for="contactNumber">Contact Number</label>
                <input type="text" id="contactNumber" class="form-control" formControlName="contactNumber"
                    placeholder="Enter Registered Number">
                <span id="contactNumberError" class="text-danger"
                    *ngIf="resetPasswordForm.controls['contactNumber'].invalid && resetPasswordForm.controls['contactNumber'].dirty">
                    Invalid Contact Number!!
                </span>
            </div>
            <div class="form-group mt-3">
                <span *ngIf="numberErrorMessage" class="text-danger">{{numberErrorMessage}}</span>
                <span *ngIf="numberSuccessMessage" class="text-success">{{numberSuccessMessage}}</span>
            </div>
        </div>

        <div *ngIf="isNumberValidated">
            <div class="form-group">
                <label for="password">New Password</label>
                <input type="password" id="password" formControlName="password" class="form-control"
                    placeholder="Enter New Password">
                <span id="passwordError" class="text-danger"
                    *ngIf="resetPasswordForm.controls['password'].invalid && resetPasswordForm.controls['password'].dirty">
                    Invalid Password Pattern!
                </span>
            </div>
            <div class="form-group mt-3">
                <label for="confirmPassword">Confirm New Password</label>
                <input type="password" id="confirmPassword" formControlName="confirmPassword" class="form-control"
                    placeholder="Confirm New Password">
                <span id="confirmPasswordError" class="text-danger"
                    *ngIf="resetPasswordForm.controls['confirmPassword'].invalid && resetPasswordForm.controls['confirmPassword'].dirty">
                    Passwords do not match.
                </span>
            </div>
            <div class="form-group mt-3">
                <span *ngIf="passswordErrorMessage" class="text-danger">{{passswordErrorMessage}}</span>
                <span *ngIf="passwordSuccessMessage" class="text-success">{{passwordSuccessMessage}}</span>
            </div>
        </div>
    </form>

    <ng-template pTemplate="footer">
        <div *ngIf="!isNumberValidated" class="d-flex justify-content-between">
            <button type="button" class="btn btn-primary" 
                [disabled]="resetPasswordForm.controls['contactNumber'].invalid"
                (click)="validateContactNumber()">Validate Number</button>
            <button type="button" class="btn btn-secondary" (click)="closeDialog()">Cancel</button>
        </div>
        <div *ngIf="isNumberValidated" class="d-flex justify-content-between">
            <button type="button" class="btn btn-success" 
                [disabled]="resetPasswordForm.controls['password'].invalid || 
                          resetPasswordForm.controls['confirmPassword'].invalid"
                (click)="resetPassword()">Change Password</button>
            <button type="button" class="btn btn-danger" (click)="closeDialog()">Cancel</button>
        </div>
    </ng-template>
</p-dialog>